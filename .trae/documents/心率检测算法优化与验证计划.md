我将分两步对后端代码进行改进，以提升心率检测的准确性和稳定性：

1. **优化核心算法 (`backend/app/services/rppg.py`)**：

   * **引入皮肤分割 (Skin Segmentation)**：不再简单截取矩形区域，而是将 ROI 转换到 **YCrCb 颜色空间**，利用皮肤的色度范围（Cr: 133-173, Cb: 77-127）生成掩膜。仅统计掩膜内（即真实皮肤区域）的像素值，剔除头发、背景等干扰。

   * **增加 BPM 平滑处理 (Stabilization)**：引入**滑动平均滤波器 (Moving Average Filter)**。维护一个长度为 5 的 BPM 历史队列，输出加权平均值，防止心率读数大幅度跳变。

   * **优化信号提取**：确保仅在有效像素足够多时才计算信号，避免噪声误判。

2. **实现多线程并行处理 (`backend/app/api/websocket_routes.py`)**：

   * 使用 `asyncio` 的 `run_in_executor` 将计算密集型的 `process_frame` 函数放入**线程池**中执行。

   * 确保 WebSocket 的接收和发送循环不会被图像处理逻辑阻塞，从而提高系统的实时响应能力和帧率稳定性。

**验证计划**：

* 重启后端服务。

* 再次运行前端进行测试，观察心率数值是否比之前更稳定（跳变减少），以及 ROI 区域（如果有可视化）是否更准确。

